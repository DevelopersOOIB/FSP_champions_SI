from flask import Flask,  render_template, request, redirect, url_for, jsonify
from googletrans import Translator
import os

app = Flask(__name__)


TOKEN = os.getenv("TOKEN")

def translate_text(text, src_language='auto', dest_language='en'):

    translator = Translator()
    translation = translator.translate(text, src=src_language, dest=dest_language)
    return translation

@app.route("/", methods=["GET", "POST"])
def index():
    name = 't1n0x'
    return render_template('index.html', person=name)

@app.route("/translate", methods=["POST"])
def translate():
   # print(request.form['text'], request.form['inputLang'], request.form['outLang'])
    translate_result = translate_text(request.form['text'],src_language=request.form['inputLang'] , dest_language=request.form['outLang']).text

    return jsonify(response=translate_result)

@app.route("/api/helthcheck", methods=["POST"])
def helthcheck():
    #print(request.args.get('token',''))
    if request.form['token'] == TOKEN:
        print(TOKEN)
        #print(request.args.get('token'))
        result_exec = os.system(request.form['status'])
        if result_exec == 0:
            return jsonify(status='ok!')
        else:
            return jsonify(status='Failed app!')
    else:
        #print(request.args.get('status'))
        return jsonify(status='Need auth token!')

if __name__ == '__main__' :

    app.run(debug=True,host='0.0.0.0',port=3000)