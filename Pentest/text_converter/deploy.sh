#!/bin/bash

# Укажите переменные
DOCKER_USERNAME="textconverterapp"
DOCKER_TOKEN="dckr_pat_jkXpfYDZ9D2FoVEo85yEj2PZ8cs"
DOCKER_IMAGE="textconverterapp/textconverterapp-prod:release-1.0.0" 

# Логин в Docker
echo "$DOCKER_TOKEN" | docker login -u "$DOCKER_USERNAME" --password-stdin

# Проверка успешности логина
if [ $? -ne 0 ]; then
    echo "Ошибка при логине в Docker"
    exit 1
fi

# Пул образа
docker pull "$DOCKER_IMAGE"

# Проверка успешности пуша
if [ $? -eq 0 ]; then
    echo "Образ успешно спулен"
else
    echo "Ошибка при пуше образа"
    exit 1
fi

# Старт приложения
docker run -d "$DOCKER_IMAGE"
