# Elgamal
**Описание**: не умею работать с эллиптическими кривыми и учиться не хочу. Разберись с этим шифром.
Это обычный шифр **Эль-Гамаля** на эллиптических кривых. Стоит обратит внимание на то, можно ли решить задачу дискретного логарифмирования. Для этого найдём порядок этой кривой:
`E.order = 310717010502520989590206149059164677804`
Оно сильно составное, а значит можно применить атаку **Полига-Хеллмана**. 
Для решения можно использовать следующий код на **SageMath**:
```python
p = 310717010502520989590157367261876774703
a = 2
b = 3
E = EllipticCurve(GF(p), [a, b])
G = E(265971779043044858474326956531102878248, 281810585061582720276638436615727518756)
D = E(70506406589376670903314165065238861388, 299278463937171527149892686595554463059)
R = E(71072873155176019225024888269554111138, 215731274317404569068698457796770300713)
c = 258792822657738531227335786127338013654

def main():
    print(E.order())
    u = G.discrete_log(D)
    print(u)
    m = (c * pow((u*R).xy()[0], -1, p)) % p
    flag = int(m).to_bytes((int(m).bit_length() // 8) + 1, byteorder = 'big')
    print(flag)
    
if __name__ == "__main__":
    main()
```
**Ответ**: flag{P0l_H3m1N} 
